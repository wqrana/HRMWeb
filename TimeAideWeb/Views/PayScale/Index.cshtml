@model IEnumerable<TimeAide.Web.Models.PayScale>
@{
    ViewBag.Title = "Pay Scale";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<div class="page-header">
    <div class="row align-items-center">
        <div class="col-sm-12">
            <h3 class="page-title">Pay Scale</h3>
            <ul class="breadcrumb">
                <li class="breadcrumb-item">Master Data</li>
                <li class="breadcrumb-item active">Pay Scale</li>
            </ul>
            <div class="alert" style="display:none;" id="IndexPageAlert">
                <a href="javascript:void(0)" class="close" id="alertDismiss">&times;</a>
                <strong>Alert!</strong><span></span>
            </div>
        </div>

    </div>
</div>

<div style="padding:0px">
    <div style="font-size: 90%;">
        <div class="form-group row">
            <div class="col-md-4 p-0">
                <!-- <div class="panel panel-default" style="width:49%;margin-left:10px">-->
                <div class="panel panel-default" style="margin-left:5px">
                    <div class="panel-heading" style="padding-left:10px">
                        Pay Scale List
                        <div class="pull-right dropdown-action" style="height:20px;">

                            <a href="#" title="Action Menu" class="action-icon dropdown-toggle" data-toggle="dropdown" aria-expanded="false"><i class="material-icons">more_horiz</i></a>
                            <div class="dropdown-menu dropdown-menu-right" x-placement="bottom-end" style="position: absolute; will-change: transform; top: 0px; left: 0px; transform: translate3d(25px, 20px, 0px);">
                                @*<a href="javascript:createEditPayScale(0);" class="dropdown-item"><i class="fa fa-plus m-r-5"></i> Add</a>*@
                                <a href="javascript:void(0);" class="anchorAddPayScale dropdown-item"><i class="fa fa-plus m-r-5"></i> Add</a>
                            </div>
                        </div>
                    </div>
                    <div class="panel-body">
                        @*<div class="col-auto float-right ml-auto">
                                <a href="" data-toggle="modal" data-target="#employeeCreateEdit_modal" class="btn add-btn"><i class="fa fa-plus"></i> Add New Scale</a>
                            </div>*@

                        <div class="table-responsive">
                            <table class="table table-striped custom-table table-nowrap mb-0">
                                <tr>
                                    <th>
                                        Id
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.PayScaleName)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.RateFrequencyId)
                                    </th>
                                    <th></th>
                                </tr>

                                @foreach (var item in Model)
                                {
                                    <tr>
                                        <td>
                                            <a href="javascript:getPayScaleLevel(@item.Id);">@Html.DisplayFor(modelItem => item.Id)</a>
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.PayScaleName)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.RateFrequency.RateFrequencyName)
                                        </td>

                                        <td width="10%">
                                            <div class="dropdown dropdown-action">
                                                <a href="#" class="action-icon dropdown-toggle" data-toggle="dropdown" aria-expanded="false"><i class="material-icons">more_vert</i></a>
                                                <div class="dropdown-menu dropdown-menu-right" x-placement="bottom-end" style="position: absolute; will-change: transform; top: 0px; left: 0px; transform: translate3d(38px, 32px, 0px);">
                                                    @if ((bool)(ViewBag.AllowEdit ?? false))
                                                    {
                                                        <a href="javascript:void(0);" id="anchorEditPayScale" class="dropdown-item" data-id="@item.Id"><i class="fa fa-pencil m-r-5"></i> Edit</a>

                                                    }
                                                    @if ((bool)(ViewBag.AllowView ?? false))
                                                    {
                                                        <a href="javascript:void(0);" id="anchorDetailPayScale" class="dropdown-item" data-id="@item.Id"><i class="fa fa-eye m-r-5"></i> Detail</a>
                                                    }
                                                    @if ((bool)(ViewBag.AllowDelete ?? false))
                                                    {
                                                        <a href="javascript:void(0);" id="anchorDeletePayScale" class="dropdown-item" data-id="@item.Id"><i class="fa fa-trash-o m-r-5"></i> Delete</a>
                                                    }
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                }

                            </table>
                        </div>

                    </div>

                </div>
            </div>
            <div class="col-md-8 p-0">

                <div id="divPayScaleLevel">

                </div>

            </div>

        </div>
    </div>
</div>

<div id="divCreateEditDelPopUp">

</div>

<script>

    $(document).ready(function () {
        getPayScaleLevel(null);
    });


    function getPayScaleLevel(scaleId) {
        debugger;
        $.ajax({
            type: "get",
            url: '/PayScaleLevel/IndexByPayScale',
            data: { "id": scaleId },

            success: function (data) {
                // debugger;
                //console.log(data);
                $("#divPayScaleLevel").html(data);
                //$("#PayScaleCreateEdit_modal").modal("show");

            },
            error: function () {
                alert(data.ErrorMessage);
            }
        });
    }
    function getPayScaleItemDetail(scaleId) {
        if (scaleId != '') {

            $.ajax({
                type: "get",
                url: '/PayScale/Details',
                data: { "id": scaleId },

                success: function (data) {
                    //debugger;
                    $("#divCreateEditDelPopUp").html(data);
                    $("#PayScaleCreateEdit_modal").modal("show");

                },
                error: function () {
                    // displayWarningMessage(data.ErrorMessage);
                }
            });
        }
    }

    function fnAddPayScaleLevel(actionMethod) {
        debugger;
        var $buttonClicked = $(this);
        var id = $buttonClicked.attr('data-id');
        var options = { "backdrop": "static", keyboard: true };
        var model = {
            PayScaleLevelRate: $('#PayScaleLevelRate').val(),
            PayScaleId: $('#PayScaleId').val()
        }

        if (actionMethod == "Edit") {
            model['Id'] = $('#Id').val();
        }
        


        $.ajax({
            type: "post",
            url: '/PayScaleLevel/' + actionMethod, 
            contentType: "application/json; charset=utf-8",
            data: JSON.stringify(model),
            datatype: "json",
            success: function (data) {
                //debugger;
                $('#myModal').modal('hide');
                getPayScaleLevel($('#PayScaleId').val());

            },
            error: function (xhr, ajaxOptions, thrownError) {
                alert(xhr.status);
                alert("Dynamic content load failed.");
            }
        });
    }
</script>

<script type="text/javascript">
    $('*[id*=anchorDetailPayScale]').click(function () {
    //debugger;
    var $buttonClicked = $(this);
    var id = $buttonClicked.attr('data-id');
    var options = { "backdrop": "static", keyboard: true };
    $.ajax({
        type: "GET",
        url: '/@ViewBag.FormName/Details',
        contentType: "application/json; charset=utf-8",
        data: { "Id": id },
        datatype: "json",
        success: function (data) {
            //debugger;
            $('#myModalContent').html(data);
            $('#myModal').modal(options);
            $('#myModal').modal('show');

        },
        error: function () {
            alert("Dynamic content load failed.");
        }
    });
});
    
    $(".anchorAddPayScale").click(function () {
    debugger;
    var $buttonClicked = $(this);
    var id = $buttonClicked.attr('data-id');
    var options = { "backdrop": "static", keyboard: true };
    $.ajax({
        type: "GET",
        url: '/@ViewBag.FormName/Create',
        contentType: "application/json; charset=utf-8",
        data: { "Id": id },
        datatype: "json",
        success: function (data) {
            //debugger;
            $('#myModalContent').html(data);
            $('#myModal').modal(options);
            $('#myModal').modal('show');

        },
        error: function (xhr, ajaxOptions, thrownError) {
            alert(xhr.status);
            alert("Dynamic content load failed.");
        }
    });
    });
    $('*[id*=anchorEditPayScale]').click(function () {
    //debugger;
    var $buttonClicked = $(this);
    var id = $buttonClicked.attr('data-id');
    var options = { "backdrop": "static", keyboard: true };
    $.ajax({
        type: "GET",
        url: '/@ViewBag.FormName/Edit',
        contentType: "application/json; charset=utf-8",
        data: { "Id": id },
        datatype: "json",
        success: function (data) {
            //debugger;
            $('#myModalContent').html(data);
            $('#myModal').modal(options);
            $('#myModal').modal('show');

        },
        error: function () {
            alert("Dynamic content load failed.");
        }
    });
});

    $('*[id*=anchorDeletePayScale]').click(function () {
    //debugger;
    var $buttonClicked = $(this);
    var id = $buttonClicked.attr('data-id');
    var options = { "backdrop": "static", keyboard: true };
    $.ajax({
        type: "GET",
        url: '/@ViewBag.FormName/Delete',
        contentType: "application/json; charset=utf-8",
        data: { "Id": id },
        datatype: "json",
        success: function (data) {
            //debugger;
            $('#myModalContent').html(data);
            $('#myModal').modal(options);
            $('#myModal').modal('show');

        },
        error: function () {
            alert("Dynamic content load failed.");
        }
    });
});
</script>