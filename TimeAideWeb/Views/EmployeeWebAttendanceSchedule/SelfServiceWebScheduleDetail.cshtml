@model IEnumerable<TimeAide.Web.Models.EmployeeAttendenceSchDetail>
@{
    byte[] companyLogo = ViewBag.CompanyLogo;

    TimeAide.Web.Models.EmployeeAttendenceSchedule SelfServiceWebSchedule = ViewBag.SelfServiceWebSchedule;
    var startDate = "";
    var endDate = "";
    var schId = 0;

    if (SelfServiceWebSchedule != null)
    {
        startDate = (SelfServiceWebSchedule.dStartDate ?? DateTime.Today).ToString("ddd MM/dd/yyyy");
        endDate = (SelfServiceWebSchedule.dEndDate ?? DateTime.Today).ToString("ddd MM/dd/yyyy");
        schId = SelfServiceWebSchedule.Id;

    }
}
@Html.Hidden("schId", schId)
<div class="row">
    <div class="col-md-12">
        <div class="card mb-0">
            <div class="card-body">
                <div class="row pb-0 mb-0">
                    <div class="col-sm-10">

                        <h4 class="payslip-title">Self Service Schedule</h4>
                    </div>
                    <div class="col-sm-2">
                        <div class="col-auto float-right ml-auto">
                            <div class="btn-group btn-group-sm">
                                @*<button class="btn btn-white">PDF</button>*@
                                <button class="btn btn-white" onclick="javascript:runLocalReport()"><i class="fa fa-print fa-lg"></i> Print</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6">
                        @{
                            var cmpImgsrc = "~/Images/no-profile-image.jpg";
                            if (companyLogo != null && companyLogo.Length > 0)
                            {
                                var base64 = Convert.ToBase64String(companyLogo);
                                cmpImgsrc = string.Format("data:image/jpg;base64,{0}", base64);
                            }
                        }
                        <img src="@cmpImgsrc" class="inv-logo" alt="">

                    </div>
                    <div class="col-sm-6">
                        <div class="invoice-details">
                            <h4 class="text-uppercase">Pay Period:@Html.DisplayFor(m => SelfServiceWebSchedule.nPayWeekNum)</h4>
                            <ul class="list-unstyled">
                                <li>Start Date: <span>:@Html.DisplayFor(m => startDate)</span></li>
                                <li>End Date: <span>@Html.DisplayFor(m => endDate)</span></li>
                            </ul>
                            <div class="pr-0 font-weight-lighter" style="text-align:left">
                              @Html.DisplayFor(m => SelfServiceWebSchedule.sNote)
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg-12">
                        <ul class="list-unstyled mb-1">
                            <li><h5 class="mb-0"><strong>@Html.DisplayFor(m => SelfServiceWebSchedule.sUserName)</strong></h5></li>
                            <li>Employee ID:@Html.DisplayFor(m => SelfServiceWebSchedule.EmployeeId)</li>

                        </ul>
                      
                    </div>
                </div>
                <div class="row">
                    <div class="table-responsive">
                        <table class="table table-condensed table-nowrap mb-0">

                            <thead>
                                <tr>
                                    <th>Punch Date</th>
                                    @*<th>Punch-In/Out Detail</th>*@
                                    <th>Punch-In 1</th>
                                    <th>Punch-Out 1</th>
                                    <th>Punch-In 2</th>
                                    <th>Punch-Out 2</th>
                                    <th>Day Hour(s)</th>
                                    <th>Note</th>

                                </tr>
                            </thead>
                            @if (Model != null)
                            {
                                foreach (var item in Model)
                                {

                                    <tr>

                                        <td>
                                            @{ var punchDate = (item.dPunchDate.Value).ToString("ddd, MMMM dd yyyy");}
                                            @Html.DisplayFor(modelItem => punchDate)
                                        </td>
                                        <td>
                                            @{ var PunchIn1 = (item.dPunchIn1 == null) ? "" : item.dPunchIn1.Value.ToString("MM/dd hh:mm tt");
                                                if (item.nPunchNum < 1) { PunchIn1 = ""; }

                                                var PunchOut1 = (item.dPunchOut1 == null) ? "" : item.dPunchOut1.Value.ToString("MM/dd hh:mm tt");
                                                if (item.nPunchNum < 2) { PunchOut1 = ""; }

                                                var PunchIn2 = (item.dPunchIn2 == null) ? "" : item.dPunchIn2.Value.ToString("MM/dd hh:mm tt");
                                                if (item.nPunchNum < 4) { PunchIn2 = ""; }

                                                var PunchOut2 = (item.dPunchOut2 == null) ? "" : item.dPunchOut2.Value.ToString("MM/dd hh:mm tt");
                                                if (item.nPunchNum < 4) { PunchOut2 = ""; }

                                                var dayPunchSch = "";
                                                if (PunchIn1 != "") { dayPunchSch += PunchIn1; }
                                                if (PunchOut1 != "") { dayPunchSch += "  |  " + PunchOut1; }
                                                if (PunchIn2 != "") { dayPunchSch += "  |  " + PunchIn2; }
                                                if (PunchOut2 != "") { dayPunchSch += "  |  " + PunchOut2; }

                                                if (item.nWorkDayType == 0) { dayPunchSch = item.sWorkDayTypeName;
                                                    item.dblDayHours = 0;
                                                    PunchIn1=PunchOut1=PunchIn2=PunchOut2= dayPunchSch;
                                                }

                                            }
                                            @* @Html.DisplayFor(modelItem => dayPunchSch)*@
                                            @Html.DisplayFor(modelItem => PunchIn1)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => PunchOut1)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => PunchIn2)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => PunchOut2)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.dblDayHours)
                                        </td>
                                        <td> @Html.DisplayFor(modelItem => item.sNote)</td>
                                    </tr>
                                }
                            }
                            <tfoot>
                                <tr>
                                    <td colspan="5" align="right"></td>
                                    <td td colspan="2" class="font-weight-bold" align="left">
                                        @Html.DisplayFor(m => SelfServiceWebSchedule.dblPeriodHours)
                                    </td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>





                </div>
            </div>
        </div>
    </div>
</div>
