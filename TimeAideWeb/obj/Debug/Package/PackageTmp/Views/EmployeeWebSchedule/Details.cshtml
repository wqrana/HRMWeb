@model TimeAide.Web.Models.UserInformation
    <style>
        .showField {
            display: block;
        }

        .hideField {
            display: none;
        }
    </style>
<div style="padding:0px">
    <div style="font-size: 90%;">
        <div class="form-group row">
            <div class="col-md-6 p-0">
                <!-- <div class="panel panel-default" style="width:49%;margin-left:10px">-->
                <div class="panel panel-default" style="margin-left:5px">
                    <div class="panel-heading" style="padding-left:10px">
                        Web Schedule
                        <div class="pull-right dropdown-action" style="height:20px;">
                            <a href="#" title="Action Menu" class="action-icon dropdown-toggle" data-toggle="dropdown" aria-expanded="false"><i class="material-icons">more_horiz</i></a>
                            <div class="dropdown-menu dropdown-menu-right" x-placement="bottom-end" style="position: absolute; will-change: transform; top: 0px; left: 0px; transform: translate3d(25px, 20px, 0px);">
                                <a id="" href="javascript:editWebScheduleType();" class="dropdown-item"><i class="fa fa-plus m-r-5"></i> Edit</a>
                            </div>
                        </div>
                    </div>
                    <div class="panel-body">
                        @{ 
                            var showBaseSchCls = (Model.IsRotatingSchedule ?? false) ? "hideField" : "showField";
                        }
                        <div class="form-group row">
                            <label class="col-md-3 col-form-label" style="margin-left:10px">
                                Rotating Schedules
                            </label>
                            <div class="col-md-1 text-muted mt-2">
                                @Html.CheckBox("IsRotatingSchedule", Model.IsRotatingSchedule ?? false, new { @disabled = "disabled" })
                            </div>
                            <label id="lblBaseSchedule" class="col-md-3 col-form-label @showBaseSchCls" style="margin-left:10px">
                                Base Schedule
                            </label>
                            <div id="divBaseSchedule" class="col-md-5 text-muted mt-2 @showBaseSchCls">
                                @Html.DisplayFor(m => m.BaseSchedule.Name)
                            </div>
                        </div>                        
                        <div class="form-group row mb-0" id="">
                            <div class="col-md-12">
                                <div id="divWebScheduleViewType">

                                </div>
                            </div>
                        </div>

                    </div>

                </div>
            </div>

        </div>
    </div>
</div>
<div id="divAddEditDelSchedule">

</div>
@Html.Partial("WebScheduleTypeEdit")
<script>
    $(document).ready(function () {
        getWebScheduleTypeDetail();
        //$("#btnSaveScheduleType").click(function () {
        //    debugger;
        //    var isRotating = $("#IsRotatingEdit").is(":checked");
        //    $("#IsRotating").prop("checked", isRotating);
        //    if (isRotating) {
        //        $("#divRotatingSchedule").show();
        //        $("#divBaseSchedule").hide();
        //        $("#divFutureSchedule").hide();
        //    }
        //    else {
        //        $("#divBaseSchedule").show();
        //        $("#divFutureSchedule").show();
        //        $("#divRotatingSchedule").hide();
        //    }
        //    $("#webScheduleEdit_modal").modal("hide");
        //});
    });
    function editWebScheduleType() {
        var isRotating = $("#IsRotatingSchedule").is(":checked");
        $("#IsRotatingScheduleEdit").prop("checked", isRotating);
        $("#webScheduleTypeEdit_modal").modal("show");
    }
    function saveScheduleTypeData() {
        var obj = new Object();
        obj.IsRotatingSchedule = $("#IsRotatingScheduleEdit").is(":checked");
        obj.UserInformationId = UserInformationId = @Model.Id;

        $.ajax({
            url: "/EmployeeWebSchedule/EditWebScheduleType",
            type: "POST",
            data: JSON.stringify(obj),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                debugger;
                if (data.status == "Success") {
                    $("#IsRotatingSchedule").prop("checked", obj.IsRotatingSchedule);
                    var addBaseSchCls = "showField";
                    var removeBaseSchCls = "hideField";
                    if (obj.IsRotatingSchedule) {
                        addBaseSchCls = "hideField";
                        removeBaseSchCls = "showField";
                    }
                    $("#lblBaseSchedule").removeClass(removeBaseSchCls).addClass(addBaseSchCls);
                    $("#divBaseSchedule").removeClass(removeBaseSchCls).addClass(addBaseSchCls);
                    getWebScheduleTypeDetail();
                    $("#webScheduleTypeEdit_modal").modal("hide");
                }
                else if (data.status == "Error") {

                    showAlertAutoHide("", "Error", data.message);
                }

            }
            ,
            error: function (data) {
                showAlertAutoHide("", "Error", data.message);

            }
        });
    }
    function getWebScheduleTypeDetail() {
        $.ajax({
            type: "GET",
            url: '/EmployeeWebSchedule/GetWebScheduleTypeDetail',
            data: { "id": @Model.Id },
            success: function (data) {
                debugger;
                $("#divWebScheduleViewType").html(data);

            },
            error: function () {
            }
        });
    }
    function addEditFutureSchedule(id) {
         $.ajax({
            type: "GET",
            url: '/EmployeeWebSchedule/AddEditFutureSchedule',
            data: { "id": id },
            success: function (data) {
                debugger;
                $("#divAddEditDelSchedule").html(data);
                $("#webFutureScheduleAddEdit_modal").modal("show");
            },
            error: function () {
            }
        });
    }
    function saveFutureSchedule() {

            debugger;
            var alertID = "#";
            var isRequiredValidated = 0;
            var isValidated = true;
            var message = "";
            var dataObj = new Object();
            dataObj.id = $('#FutureScheduleId').val();
            dataObj.UserInformationId =@Model.Id;
            dataObj.StartDate = $('#StartDate').val();
            dataObj.BaseScheduleId = $('#BaseScheduleId').val();
            dataObj.Note = $('#FutureScheduleNote').val();


            if (dataObj != null) {
                isRequiredValidated += dataObj.StartDate.trim().length > 0 ? 1 : 0;
                isRequiredValidated += dataObj.BaseScheduleId.trim().length > 0 ? 1 : 0;


                if (isRequiredValidated != 2) {
                    isValidated = false;
                    message = " Missing Required field(s)";
                }
            }

            if (!isValidated) showAlertAutoHide(alertID, 'Error', message);

            if (isValidated) {
                // ajax call for saving data
                $.ajax({
                    type: "POST",
                    url: "/EmployeeWebSchedule/AddEditFutureSchedule",
                    data: JSON.stringify(dataObj),
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (data) {
                        //debugger;
                        if (data.status == "Success") {
                            $("#webFutureScheduleAddEdit_modal").modal("hide");
                            showAlertAutoHide(alertID, data.status, data.message);
                            getWebScheduleTypeDetail();
                        }
                        else {
                            showAlertAutoHide(alertID, data.status, data.message);
                        }
                    }
                    ,
                    error: function (request, status, error) {
                        alert('Error in deleting parent alert data');
                        return false;
                    }
                });
            }

    }

    function getFutureScheduleDeleteData(id) {
        $.ajax({
            type: "GET",
            url: '/EmployeeWebSchedule/DeleteFutureSchedule',
            data: { "id": id },
            success: function (data) {
                debugger;
                $("#divAddEditDelSchedule").html(data);
                $("#futureScheduleDelete_modal").modal("show");
            },
            error: function () {
            }
        });
    }
    function deleteFutureSchedule(id) {
        if (id != '') {
            $.ajax({
                type: "Post",
                url: "/EmployeeWebSchedule/ConfirmDeleteFutureSchedule",
                data: { "id": id },
                dataType: "json",
                success: function (data) {
                    debugger;
                    if (data.status == "Success") {
                        $("#futureScheduleDelete_modal").modal("hide");
                        showAlertAutoHide("#", data.status, data.message);
                        getWebScheduleTypeDetail();
                    }
                    else {
                        showAlertAutoHide("", data.status, data.message);
                    }
                }
                ,
                error: function (request, status, error) {
                    showAlertAutoHide("", "Error", error);
                    return false;
                }
            });
        }

    }
    //Rotating Schedule
     function addEditRotatingSchedule(id) {
         $.ajax({
            type: "GET",
            url: '/EmployeeWebSchedule/AddEditRotatingSchedule',
            data: { "id": id },
            success: function (data) {
                debugger;
                $("#divAddEditDelSchedule").html(data);
                $("#webRotatingScheduleAddEdit_modal").modal("show");
            },
            error: function () {
            }
        });
    }
    function saveRotatingSchedule() {

            debugger;
            var alertID = "#";
            var isRequiredValidated = 0;
            var isValidated = true;
            var message = "";
            var dataObj = new Object();
            dataObj.id = $('#RotatingScheduleId').val();
            dataObj.UserInformationId =@Model.Id;           
            dataObj.BaseScheduleId = $('#BaseScheduleId').val();
            dataObj.Note = $('#RotatingScheduleNote').val();


            if (dataObj != null) {
               
                isRequiredValidated += dataObj.BaseScheduleId.trim().length > 0 ? 1 : 0;


                if (isRequiredValidated != 1) {
                    isValidated = false;
                    message = " Missing Required field(s)";
                }
            }

            if (!isValidated) showAlertAutoHide(alertID, 'Error', message);

            if (isValidated) {
                // ajax call for saving data
                $.ajax({
                    type: "POST",
                    url: "/EmployeeWebSchedule/AddEditRotatingSchedule",
                    data: JSON.stringify(dataObj),
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (data) {
                        //debugger;
                        if (data.status == "Success") {
                            $("#webRotatingScheduleAddEdit_modal").modal("hide");
                            showAlertAutoHide(alertID, data.status, data.message);
                            getWebScheduleTypeDetail();
                        }
                        else {
                            showAlertAutoHide(alertID, data.status, data.message);
                        }
                    }
                    ,
                    error: function (request, status, error) {
                        alert('Error in deleting parent alert data');
                        return false;
                    }
                });
            }

    }

    function getRotatingScheduleDeleteData(id) {
        $.ajax({
            type: "GET",
            url: '/EmployeeWebSchedule/DeleteRotatingSchedule',
            data: { "id": id },
            success: function (data) {
                debugger;
                $("#divAddEditDelSchedule").html(data);
                $("#rotatingScheduleDelete_modal").modal("show");
            },
            error: function () {
            }
        });
    }
    function deleteRotatingSchedule(id) {
        if (id != '') {
            $.ajax({
                type: "Post",
                url: "/EmployeeWebSchedule/ConfirmDeleteRotatingSchedule",
                data: { "id": id },
                dataType: "json",
                success: function (data) {
                    debugger;
                    if (data.status == "Success") {
                        $("#rotatingScheduleDelete_modal").modal("hide");
                        showAlertAutoHide("#", data.status, data.message);
                        getWebScheduleTypeDetail();
                    }
                    else {
                        showAlertAutoHide("", data.status, data.message);
                    }
                }
                ,
                error: function (request, status, error) {
                    showAlertAutoHide("", "Error", error);
                    return false;
                }
            });
        }

    }
</script>