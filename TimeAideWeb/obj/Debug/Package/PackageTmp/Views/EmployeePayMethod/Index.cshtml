<style>
    .rowZeroMargin {
        margin-left: 0px;
        margin-right: 0px;
    }
</style>

    <div style="padding:0px">
        <div style="font-size: 90%;">            
            <div class="form-group row mb-1">
                <div class="col-md-6 p-0">
                    <div class="panel panel-default" style="margin-left:5px">
                        <div class="panel-heading" style="padding-left:10px">
                            Deposit Percentage Account(s)
                            <div class="pull-right dropdown-action" style="height:20px;">
                                <a href="#" title="Action Menu" class="action-icon dropdown-toggle" data-toggle="dropdown" aria-expanded="false"><i class="material-icons">more_horiz</i></a>
                                <div class="dropdown-menu dropdown-menu-right" x-placement="bottom-end" style="position: absolute; will-change: transform; top: 0px; left: 0px; transform: translate3d(25px, 20px, 0px);">

                                    <a href="javascript:addEditEmployeeDepositPctAccountList();" class="dropdown-item"><i class="fa fa-plus m-r-5"></i> Add/Edit Account(s)</a>

                                </div>
                            </div>
                        </div>
                        <div class="panel-body">
                            <div id="divEmpDepositPctAccount">

                            </div>

                        </div>
                    </div>
                </div>
                <div class="col-md-6 p-0">
                    <!-- <div class="panel panel-default" style="width:49%;margin-left:10px">-->
                    <div class="panel panel-default" style="margin-left:5px">
                        <div class="panel-heading" style="padding-left:10px">
                            Cash Amount Account(s)
                            <div class="pull-right dropdown-action" style="height:20px;">
                                <a href="#" title="Action Menu" class="action-icon dropdown-toggle" data-toggle="dropdown" aria-expanded="false"><i class="material-icons">more_horiz</i></a>
                                <div class="dropdown-menu dropdown-menu-right" x-placement="bottom-end" style="position: absolute; will-change: transform; top: 0px; left: 0px; transform: translate3d(25px, 20px, 0px);">

                                    <a href="javascript:addEditEmployeeCashAmountAccount(0);" class="dropdown-item"><i class="fa fa-plus m-r-5"></i> Add Account</a>

                                </div>
                            </div>
                        </div>
                        <div class="panel-body">
                            <div id="divEmpCashAmountAccount">

                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

<div id="divPayAccountCreateEdit">
</div>
<script>
    $(document).ready(function () {
        debugger;
        var userId = $("#userID").val();
        retrieveEmployeeAccountByDepositPct(userId);
        retrieveEmployeeAccountByCashDeposit(userId);
        
        
    });

    function retrieveEmployeeAccountByCashDeposit(userId) {
       // $("#divLoadingLicensesTab").show();
        $.ajax({
            type: "get",
            url: '/EmployeePayMethod/AccountByCashDepositDetail',
            data: { "id": userId },

            success: function (data) {
                //debugger;
                //console.log(data);
                $("#divEmpCashAmountAccount").html(data);
               // $("#divLoadingLicensesTab").hide();
            },
            error: function () {
                showAlertAutoHide("", "Error", data.ErrorMessage);
            }
        });
    }
    function addEditEmployeeDepositPctAccountList() {

        var userId = $("#userID").val();

        $.ajax({
            type: "get",
            url: '/EmployeePayMethod/CreateEditDepositPctAccountList',
            data: { "userId": userId },

            success: function (data) {
                //debugger;
                //console.log(data);
                $("#divPayAccountCreateEdit").html(data);
                $("#employeeDepositPctAccList_modal").modal("show");
            },
            error: function () {
                showAlertAutoHide("", "Error", data.ErrorMessage);
            }
        });
    }
   
    function ajaxGetBankRoutingNumber(bankId) {
        $.ajax({
            type: "Get",
            url: "/EmployeePayMethod/AjaxGetBankRoutingNumber",
            data: { "bankId": bankId},
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                //debugger;
                $("#BankRoutingNumber").val(data);
               }
            ,
            error: function (request, status, error) {
                alert('Error in ajax call');
                return false;
            }
        });
    }   
    
    function addEditEmployeeCashAmountAccount(id) {
        // divEmployeeLicensesCreateEdit
        var userId = $("#userID").val();

        $.ajax({
            type: "get",
            url: '/EmployeePayMethod/CreateEditCashAmountAccount',
            data: { "id": id, "userId": userId },

            success: function (data) {
                //debugger;
                //console.log(data);
                $("#divPayAccountCreateEdit").html(data);
                $("#employeeCashAmountAccCreateEdit_modal").modal("show");
            },
            error: function () {
                showAlertAutoHide("", "Error", data.ErrorMessage);
            }
        });
    }
    function saveEmployeeCashAmountAccountData() {
        debugger;
        var alertID = "#";
        var isRequiredValidated = 0;
        var isValidated = true;
        var message = "";
        var dataObj = new Object();
        dataObj.UserInformationId = $("#userID").val();
        dataObj.Id = $('#EmployeePayAccountId').val();
        dataObj.Name = $('#AccountName').val();
        dataObj.BankAccountTypeId = $('#BankAccountTypeId').val();
        dataObj.AccountNumber = $('#AccountNumber').val();
        dataObj.PayBankId = $('#PayBankId').val();
        dataObj.DepositAmt = $('#DepositAmt').val();
        dataObj.IsPrimary = $('#IsPrimaryAE').is(":checked");
        dataObj.EndDate = $('#EndDate').val();
        dataObj.PayType = $('#PayType').val();

        if (dataObj != null) {
            isRequiredValidated += dataObj.Name.trim().length > 0 ? 1 : 0;
            isRequiredValidated += dataObj.BankAccountTypeId.trim().length > 0 ? 1 : 0;
            isRequiredValidated += dataObj.AccountNumber.trim().length > 0 ? 1 : 0;
            isRequiredValidated += dataObj.PayBankId.trim().length > 0 ? 1 : 0;

            if (isRequiredValidated != 4) {
                isValidated = false;
                message = " Missing Required field(s)";
            }
        }

        if (!isValidated) showAlertAutoHide(alertID, 'Error', message);

        if (dataObj.EndDate != "") {
            var todayDate = new Date();
            if (moment(dataObj.EndDate) > moment(todayDate)) {
                showAlertAutoHide("", 'Error', "End Date shouldn't be in future.");
                return;
            }
            dataObj.DepositAmt = "0.00";
        }
        if (isValidated) {
            // ajax call for saving data
            $.ajax({
                type: "POST",
                url: "/EmployeePayMethod/CreateEditCashAmountAccount",
                data: JSON.stringify(dataObj),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {
                    //debugger;
                    if (data.status == "Success") {
                        $("#employeeCashAmountAccCreateEdit_modal").modal("hide");
                        showAlertAutoHide("#", data.status, data.message);
                        retrieveEmployeeAccountByCashDeposit(dataObj.UserInformationId);
                        retrieveEmployeeAccountByDepositPct(dataObj.UserInformationId);
                    }
                    else {
                        showAlertAutoHide(alertID, data.status, data.message);
                    }
                }
                ,
                error: function (request, status, error) {
                    alert('Error in  action call');
                    return false;
                }
            });
        }
    }

    function getEmployeeCashAccountDeleteData(id) {
        $.ajax({
            type: "get",
            url: '/EmployeePayMethod/DeleteCashAccount',
            data: { "id": id },

            success: function (data) {
                //debugger;
                //console.log(data);
                $("#divPayAccountCreateEdit").html(data);
                $("#employeeCashAccountDelete_modal").modal("show");
            },
            error: function () {
                showAlertAutoHide("", "Error", data.ErrorMessage);
            }
        });
    }
    function deleteEmployeeCashAccount(id) {
        $.ajax({
            type: "Post",
            url: "/EmployeePayMethod/ConfirmDelete",
            data: { "id": id },
            dataType: "json",
            success: function (data) {
                //debugger;
                if (data.status == "Success") {
                    $("#employeeCashAccountDelete_modal").modal("hide");
                    showAlertAutoHide("#userDetailAlert", data.status, data.message);
                    var userId = $("#userID").val();
                    retrieveEmployeeAccountByCashDeposit(userId);
                    // location.reload(true);
                }
                else {
                    showAlertAutoHide(alertID, data.status, data.message);
                }
            }
            ,
            error: function (request, status, error) {
                showAlertAutoHide(alertID, "Error", error);
                return false;
            }
        });
    }
    function retrieveEmployeeAccountByDepositPct(userId) {
        //$("#divLoadingLicensesTab").show();
        $.ajax({
            type: "get",
            url: '/EmployeePayMethod/AccountByDepositPctDetail',
            data: { "id": userId },

            success: function (data) {
                debugger;
                //console.log(data);
                $("#divEmpDepositPctAccount").html(data);
                //$("#divLoadingLicensesTab").hide();
            },
            error: function () {
                showAlertAutoHide("", "Error", data.ErrorMessage);
            }
        });
    }  
    
    
   
   
   
</script>